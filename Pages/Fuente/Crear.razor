@page "/fuente/crear"
@inject FrontBlazor.Services.ServicioEntidad servicioEntidad
@inject NavigationManager navigationManager

<h3>Crear Fuente</h3>

<EditForm Model="@this" OnValidSubmit="OnSubmit">
    <div class="mb-3">
        <label>Nombre</label>
        <InputText class="form-control" @bind-Value="Nombre" />
    </div>

    <button type="submit" class="btn btn-primary">Guardar</button>
    <button class="btn btn-secondary ms-2" @onclick="Volver">Cancelar</button>
</EditForm>

@if (!string.IsNullOrWhiteSpace(mensaje))
{
    <div class="alert alert-info mt-3">@mensaje</div>
}

@code {
    private string Nombre { get; set; } = string.Empty;
    private string? mensaje;

    private async Task OnSubmit()
    {
        var nuevoRegistro = new Dictionary<string, object>
        {
            { "nombre", Nombre }
        };

        bool creado = await servicioEntidad.CrearAsync("proyecto", "fuente", nuevoRegistro);
        if (creado)
        {
            navigationManager.NavigateTo("/fuente");
        }
        else
        {
            mensaje = "Error al crear la fuente.";
        }
    }

    private void Volver()
    {
        navigationManager.NavigateTo("/fuente");
    }
}
